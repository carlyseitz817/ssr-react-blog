{"version":3,"file":"static/webpack/static\\development\\pages\\userPosts.js.fabeae5b177d6c58760f.hot-update.js","sources":["webpack:///./pages/userPosts.js"],"sourcesContent":["import React from 'react';\nimport BaseLayout from '../components/layouts/BaseLayout';\nimport BasePage from '../components/BasePage';\nimport { Container, Row, Col, Button } from 'reactstrap';\nimport PortButtonDropdown from '../components/ButtonDropdown';\n\nimport withAuth from '../components/hoc/withAuth';\nimport { Link, Router } from '../routes';\n\nimport { getUserPosts, updatePost, deletePost } from '../actions';\n\nclass UserPosts extends React.Component {\n\n  static async getInitialProps({ req }) {\n    let posts = [];\n\n    try {\n      posts = await getUserPosts(req);\n    } catch (err) {\n      console.error(err);\n    }\n\n    return { posts };\n  }\n\n  changePostStatus(status, postId) {\n    updatePost({ status }, postId)\n      .then(() => {\n        Router.pushRoute('/userPosts');\n      })\n      .catch(err => {\n        console.error(err.message);\n      })\n  }\n\n  deletePostWarning(postId) {\n    const res = confirm('Are you sure you want to delete this blog post?');\n\n    if (res) {\n      this.deletePost(postId);\n    }\n  }\n\n  deletePost(postId) {\n    deletePost(postId)\n      .then(status => {\n        Router.pushRoute('/userPosts');\n      })\n      .catch(err => console.error(err.message)\n      )\n  }\n\n  separatePosts(posts) {\n    const published = [];\n    const drafts = [];\n\n    posts.forEach((post) => {\n      post.status === 'draft' ? drafts.push(post) : published.push(post);\n    });\n\n    return { published, drafts };\n  }\n\n  createStatus(status) {\n    return status === 'draft' ? { view: 'Publish Story', value: 'published' }\n      : { view: 'Make a Draft', value: 'draft' };\n  }\n\n  dropdownOptions = (post) => {\n    const status = this.createStatus(post.status);\n\n    return [\n      { text: status.view, handlers: { onClick: () => this.changePostStatus(status.value, post._id) } },\n      { text: 'Delete', handlers: { onClick: () => this.deletePostWarning(post._id) } }\n    ]\n  }\n\n\n\n  renderPosts(posts) {\n    console.log(posts)\n    return (\n      <ul className=\"user-blogs-list\">\n        {\n          posts.map((post, index) => (\n            <li key={index}>\n              <Link route={`/blog/${post._id}/edit`}>\n                <a>{post.title}</a>\n              </Link>\n              <PortButtonDropdown items={this.dropdownOptions(post)} />\n            </li>\n          )\n          )\n        }\n      </ul>\n    )\n  }\n\n  render() {\n    const { posts } = this.props;\n    console.log(posts);\n    const {published, drafts} = this.separatePosts(posts);\n\n    return (\n      <BaseLayout {...this.props.auth} headerType={'landing'}>\n        <div className=\"masthead\" style={{ \"backgroundImage\": \"url('/static/images/home-bg.jpg')\" }}>\n          <div className=\"overlay\"></div>\n          <Container>\n            <div className=\"row\">\n              <div className=\"col-lg-8 col-md-10 mx-auto\">\n                <div className=\"site-heading\">\n                  <h1>Posts Dashboard</h1>\n                  <span className=\"subheading\">\n                    Let's write something nice today!{' '}\n                    <Link route='/blogs/new'>\n                      <Button color=\"primary mybutton\">Create a new Post</Button>\n                    </Link></span>\n                </div>\n              </div>\n            </div>\n          </Container>\n        </div>\n        <BasePage className=\"blog-user-page\">\n        <normaltext>\n          <Row>\n            <Col md=\"6\" className=\"mx-auto text-center\">\n              <h2 className=\"blog-status-title\"> Published Posts </h2>\n              {this.renderPosts(published)}\n            </Col>\n            <Col md=\"6\" className=\"mx-auto text-center\">\n              <h2 className=\"blog-status-title\"> Draft Posts </h2>\n              {this.renderPosts(drafts)}\n            </Col>\n          </Row>\n          </normaltext>\n        </BasePage>\n      </BaseLayout>\n    )\n  }\n}\n\nexport default withAuth(UserPosts);\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;;;;;;AAnDA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AAEA;AACA;AACA;AAAA;AAEA;;;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;;;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;;;AAaA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAEA;AACA;AAAA;AACA;AAAA;AAGA;AAAA;AALA;AAYA;;;AAEA;AAAA;AAEA;AACA;AAHA;AAAA;AAAA;AACA;AAIA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AAEA;AAAA;AACA;AAAA;AAOA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AAQA;;;;;;;;;;;;AA7HA;AACA;;;AAGA;AACA;;AADA;;;;;;;AAEA;AACA;;AAEA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;;;AAZA;AACA;AAiIA;;;;A","sourceRoot":""}